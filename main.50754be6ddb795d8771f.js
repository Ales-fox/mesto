!function(){"use strict";const t=document.querySelector(".profile"),e=t.querySelector(".button-edit"),s=t.querySelector(".button-add"),i=t.querySelector(".profile__avatar-hover"),r={};class n{constructor(t,e,s,i,r,n,o){this._name=t.name,this._link=t.link,this._id=t._id,this._likes=t.likes,this._ownerId=t.owner._id,this._cardSelector=e,this._handleCardClick=s,this._deleteLikes=i,this._putLikes=r,this._popupDelete=n,this._myId=o()._id,this._myName=o().name}createCard(){this._newCard=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._buttonDelete=this._newCard.querySelector(".button-delete"),this._ownerId!==this._myId&&this._buttonDelete.classList.add("button-delete_inactive"),this.titleCard=this._newCard.querySelector(".card__title"),this.buttonLike=this._newCard.querySelector(".button-like"),this.photoLinkCard=this._newCard.querySelector(".card__photo"),this.cardCountLike=this._newCard.querySelector(".card__count-like");for(let t=0;t<this._likes.length;t++)if(this._likes[t].name===this._myName){this._setClassLike();break}return this._setEventListeners(),this.titleCard.textContent=this._name,this.photoLinkCard.src=this._link,this.photoLinkCard.alt=this._name,this.cardCountLike.textContent=this._likes.length,this._newCard}_setEventListeners(){this._newCard.querySelector(".button-like").addEventListener("click",(()=>{this.buttonLike.classList.contains("button-like_active")?this._removeLike():this._addLike()})),this._buttonDelete.classList.contains("button-delete_inactive")||this._buttonDelete.addEventListener("click",(()=>{this._popupDelete(this._deleteCard.bind(this),this._id)})),this.photoLinkCard.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}_addLike(){this._putLikes(this._id).then((t=>{this._setClassLike(),this.cardCountLike.textContent=t.likes.length})).catch((t=>console.error(t)))}_removeLike(){this._deleteLikes(this._id).then((t=>{this._setClassLike(),this.cardCountLike.textContent=t.likes.length})).catch((t=>console.error(t)))}_setClassLike(){this.buttonLike.classList.toggle("button-like_active")}_deleteCard(){this._deleteDomCard(),this._newCard=null}_deleteDomCard(){this._newCard.remove()}}class o{constructor(t,e){this._config=t,this._form=e,this._inputList=Array.from(this._form.querySelectorAll("".concat(this._config.inputSelector))),this._buttonElement=this._form.querySelector("".concat(this._config.submitButtonSelector))}enableValidation(){this._setEventListeners()}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))}))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)}_showInputError(t,e){const s=this._form.querySelector(".".concat(this._config.errorClass,"_").concat(t.id));t.classList.add(this._config.inputErrorClass),s.textContent=e,s.classList.add("".concat(this._config.errorClass,"_active"))}_hideInputError(t){const e=this._form.querySelector(".".concat(this._config.errorClass,"_").concat(t.id));t.classList.remove(this._config.inputErrorClass),e.classList.remove("".concat(this._config.errorClass,"_active")),e.textContent=""}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}}class a{constructor(t){this._popup=document.querySelector(t),this._buttonClose=this._popup.querySelector(".button-close"),this._handleEscClosebind=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClosebind)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClosebind)}_handleEscClose(t){"Escape"===t.key&&this.close()}setEventListeners(){this._buttonClose.addEventListener("click",this.close.bind(this)),this._popup.addEventListener("mousedown",(t=>{t.target===t.currentTarget&&this.close()}))}}class h extends a{constructor(t,e){super(t),this.handleFormSubmit=e,this._buttonSubmit=this._popup.querySelector(".button-submit"),this._inputList=this._popup.querySelectorAll(".input"),this.setEventListeners()}_getInputValues(){return this.formValues={},this._inputList.forEach((t=>{this.formValues[t.name]=t.value})),this.formValues}setEventListeners(){this._form=this._popup.querySelector(".popup__container"),this._form.addEventListener("submit",(t=>{t.preventDefault(),this.handleFormSubmit(this._getInputValues(),this._buttonSubmit)})),super.setEventListeners()}setInputValues(t){this._inputList.forEach((e=>{e.value=t[e.name]}))}close(){this._form.reset(),super.close()}}function c(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const l=new class{constructor(t){let{baseURL:e,headers:s}=t;c(this,"postCard",(t=>fetch(this._urlCard,{method:"POST",headers:this._headers,body:JSON.stringify(t)}).then((t=>this._getResponseData(t))))),c(this,"deleteCard",(t=>fetch("".concat(this._urlCard).concat(t),{method:"DELETE",headers:this._headers}).then((t=>this._getResponseData(t))))),c(this,"putLikes",(t=>fetch("".concat(this._urlCard).concat(t,"/likes"),{method:"PUT",headers:this._headers}).then((t=>this._getResponseData(t))))),c(this,"deleteLikes",(t=>fetch("".concat(this._urlCard).concat(t,"/likes"),{method:"DELETE",headers:this._headers}).then((t=>this._getResponseData(t))))),this._baseURL=e,this._urlDataProfile="".concat(this._baseURL,"users/me/"),this._urlCard="".concat(this._baseURL,"cards/"),this._urlAvatar="".concat(this._baseURL,"users/me/avatar/"),this._headers=s}getDataProfile(){return fetch(this._urlDataProfile,{headers:this._headers}).then((t=>this._getResponseData(t)))}getDataCard(){return fetch(this._urlCard,{headers:this._headers}).then((t=>this._getResponseData(t)))}sendDataProfile(t){return fetch(this._urlDataProfile,{method:"PATCH",headers:this._headers,body:JSON.stringify(t)}).then((t=>this._getResponseData(t)))}sendDataAvatar(t){return fetch(this._urlAvatar,{method:"PATCH",headers:this._headers,body:JSON.stringify(t)}).then((t=>this._getResponseData(t)))}_getResponseData(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status,"  ").concat(t.statusText))}}({baseURL:"https://nomoreparties.co/v1/cohort-46/",headers:{authorization:"13749ec2-245f-4fcd-8f22-451e84bec66b","Content-Type":"application/json"}}),u=new class{constructor(t,e){let{renderer:s}=t;this._renderer=s,this._container=document.querySelector(e)}addItem(t){this._container.append(t)}prependItem(t){this._container.prepend(t)}clear(){this._container.innerHTML=""}renderItems(t){this.clear(),this._renderedItems=t,this._renderedItems.forEach((t=>{this._renderer(t)}))}}({renderer:t=>{const e=C(t);u.addItem(e)}},".cards"),_=new h(".popup_form_edit",(function(t,e){L(!0,e),l.sendDataProfile(t).then((t=>{b.setUserInfo(t.name,t.about),_.close()})).catch((t=>console.error(t))).finally((()=>{L(!1,e)}))})),d=new h(".popup_form_add",(function(t,e){L(!0,e),l.postCard(t).then((t=>{const e=C(t);u.prependItem(e),d.close()})).catch((t=>console.error(t))).finally((()=>{L(!1,e)}))})),p=new class extends a{constructor(t){super(t),this._popupBigPhoto=this._popup.querySelector(".popup__bigPhoto"),this._popupPhotoSubtitle=this._popup.querySelector(".popup__subtitle")}open(t,e){this._popupBigPhoto.alt=t,this._popupBigPhoto.src=e,this._popupPhotoSubtitle.textContent=t,super.open()}}(".popup_photo"),m=new class extends a{constructor(t,e){super(t),this.handleFormSubmit=e,this._setEventListeners()}_setEventListeners(){this._form=this._popup.querySelector(".popup__container"),this._form.addEventListener("submit",(t=>{t.preventDefault(),this.handleFormSubmit(this.deleteCard,this.id)})),super.setEventListeners()}open(t,e){super.open(),this.deleteCard=t,this.id=e}}(".popup_form_delete",(function(t,e){l.deleteCard(e).then((()=>{t(),m.close()})).catch((t=>console.error(t)))})),f=new h(".popup_form_updateAvatar",(function(t,e){L(!0,e),l.sendDataAvatar(t).then((t=>{b.setUserAvatar(t.avatar),f.close()})).catch((t=>console.error(t))).finally((()=>{L(!1,e)}))})),b=new class{constructor(t,e,s){var i,r;r=()=>this._userInformation,(i="getFullPackInfoObj")in this?Object.defineProperty(this,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[i]=r,this._profileName=document.querySelector(t),this._profileStatus=document.querySelector(e),this._profileAvatar=document.querySelector(s)}getUserInfo(){return this._name=this._profileName.textContent,this._about=this._profileStatus.textContent,this.info={name:this._name,about:this._about},this.info}saveServerInformation(t){this._userInformation=t}setUserInfo(t,e){this._profileName.textContent=t,this._profileStatus.textContent=e}setUserAvatar(t){this._profileAvatar.src=t}}(".profile__name",".profile__status",".profile__avatar");function C(t){return new n(t,".template__card",v,l.deleteLikes,l.putLikes,m.open.bind(m),b.getFullPackInfoObj).createCard()}function v(t,e){p.open(t,e)}function L(t,e){e.textContent=t?"Cохранение...":"Cохранить"}var k;p.setEventListeners(),k={form:".popup__container",inputSelector:".input",submitButtonSelector:".button-submit",inactiveButtonClass:"button_invalid",inputErrorClass:"input_type_error",errorClass:"input-error"},Array.from(document.querySelectorAll(k.form)).forEach((t=>{const e=new o(k,t),s=t.getAttribute("name");r[s]=e,e.enableValidation()})),Promise.all([l.getDataProfile(),l.getDataCard()]).then((t=>{let[e,s]=t;b.saveServerInformation(e),b.setUserInfo(e.name,e.about),b.setUserAvatar(e.avatar),u.renderItems(s)})),e.addEventListener("click",(function(){_.open(),_.setInputValues(b.getUserInfo())})),s.addEventListener("click",(function(){r.formCard.resetValidation(),d.open()})),i.addEventListener("click",(function(){r.formUpdateAvatar.resetValidation(),f.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aUJBQ3RCTyxvQkFBcUIsaUJBQ3JCWSxnQkFBaUIsbUJBQ2pCRixXQUFZLGVLb0JLdEIsTUFBTUMsS0FBS3hFLFNBQVN5RSxpQkFBaUJQLEVBQU9DLE9BQ3BEWSxTQUFTd0gsSUFDZCxNQUFNQyxFQUFZLElBQUl2SSxFQUFjQyxFQUFRcUksR0FFdENFLEVBQVdGLEVBQVlHLGFBQWEsUUFHMUNyTSxFQUFlb00sR0FBWUQsRUFDM0JBLEVBQVUzSCxzQkFPbEJtRSxRQUFRMkQsSUFBSSxDQUFDaEYsRUFBSWUsaUJBQWtCZixFQUFJZ0IsZ0JBQ2xDbkYsTUFBSyxJQUFnQyxJQUE5Qm9KLEVBQWVDLEdBQWUsRUFDbENwQyxFQUFTc0Isc0JBQXNCYSxHQUMvQm5DLEVBQVNDLFlBQVlrQyxFQUFjM0wsS0FBTTJMLEVBQWNqQyxPQUN2REYsRUFBU1csY0FBY3dCLEVBQWN4TSxRQUVyQ2lKLEVBQVNZLFlBQVk0QyxNQTREN0IzTSxFQUFXZ0QsaUJBQWlCLFNBQVMsV0FDakNvSCxFQUFVL0QsT0FDVitELEVBQVU5QyxlQUFlaUQsRUFBU21CLGtCQUV0Q3pMLEVBQVUrQyxpQkFBaUIsU0FBUyxXQUNoQzdDLEVBQUFBLFNBQUFBLGtCQUNBd0ssRUFBU3RFLFVBRWJuRyxFQUFPOEMsaUJBQWlCLFNBQVMsV0FDN0I3QyxFQUFBQSxpQkFBQUEsa0JBQ0E4SyxFQUFrQjVFLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9NZXN0by8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vTWVzdG8vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL01lc3RvLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9NZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL01lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9NZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9NZXN0by8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9NZXN0by8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vTWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9NZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9NZXN0by8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZScpO1xyXG5jb25zdCBidXR0b25FZGl0ID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcuYnV0dG9uLWVkaXQnKTtcclxuY29uc3QgYnV0dG9uQWRkID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcuYnV0dG9uLWFkZCcpO1xyXG5jb25zdCBhdmF0YXIgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hdmF0YXItaG92ZXInKTtcclxuY29uc3QgY29uZmlnID0ge1xyXG4gICAgZm9ybTogJy5wb3B1cF9fY29udGFpbmVyJyxcclxuICAgIGlucHV0U2VsZWN0b3I6ICcuaW5wdXQnLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcuYnV0dG9uLXN1Ym1pdCcsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAnYnV0dG9uX2ludmFsaWQnLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiAnaW5wdXRfdHlwZV9lcnJvcicsXHJcbiAgICBlcnJvckNsYXNzOiAnaW5wdXQtZXJyb3InXHJcbn07XHJcbmNvbnN0IGFwaURhdGEgPSB7XHJcbiAgICBiYXNlVVJMOiAnaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC00Ni8nLFxyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246ICcxMzc0OWVjMi0yNDVmLTRmY2QtOGYyMi00NTFlODRiZWM2NmInLFxyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgIH1cclxufTtcclxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcclxuXHJcbmV4cG9ydCB7IGJ1dHRvbkVkaXQsIGJ1dHRvbkFkZCwgY29uZmlnLCBmb3JtVmFsaWRhdG9ycywgYXZhdGFyLCBhcGlEYXRhIH07IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihvYmosIGNhcmRTZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrLCBkZWxldGVMaWtlcywgcHV0TGlrZXMsIHBvcHVwRGVsZXRlLCBmdWxsUGFja0luZm9PYmopIHtcclxuICAgICAgICB0aGlzLl9uYW1lID0gb2JqLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fbGluayA9IG9iai5saW5rO1xyXG4gICAgICAgIHRoaXMuX2lkID0gb2JqLl9pZDtcclxuICAgICAgICB0aGlzLl9saWtlcyA9IG9iai5saWtlcztcclxuICAgICAgICB0aGlzLl9vd25lcklkID0gb2JqLm93bmVyLl9pZDtcclxuICAgICAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZUxpa2VzID0gZGVsZXRlTGlrZXM7XHJcbiAgICAgICAgdGhpcy5fcHV0TGlrZXMgPSBwdXRMaWtlcztcclxuICAgICAgICB0aGlzLl9wb3B1cERlbGV0ZSA9IHBvcHVwRGVsZXRlO1xyXG4gICAgICAgIHRoaXMuX215SWQgPSBmdWxsUGFja0luZm9PYmooKS5faWQ7XHJcbiAgICAgICAgdGhpcy5fbXlOYW1lID0gZnVsbFBhY2tJbmZvT2JqKCkubmFtZTtcclxuICAgIH1cclxuICAgIC8q0KHQvtC30LTQsNC90LjQtSDQutCw0YDRgtC+0YfQutC4Ki9cclxuICAgIGNyZWF0ZUNhcmQoKSB7XHJcbiAgICAgICAgdGhpcy5fbmV3Q2FyZCA9IGRvY3VtZW50XHJcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgICAgICAgLmNvbnRlbnRcclxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJylcclxuICAgICAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcblxyXG4gICAgICAgIHRoaXMuX2J1dHRvbkRlbGV0ZSA9IHRoaXMuX25ld0NhcmQucXVlcnlTZWxlY3RvcignLmJ1dHRvbi1kZWxldGUnKTtcclxuXHJcbiAgICAgICAgLy/QldGB0LvQuCBJZCDQstC70LDQtNC10LvRjNGG0LAg0LrQsNGA0YLQvtGH0LrQuCDQvdC1INGB0L7QstC/0LDQtNCw0LXRgiDRgSDQvNC+0LjQvCBJZCwg0YLQviDQutC90L7Qv9C60LUgZGVsZXRlINC00L7QsdCw0LLQu9GP0Y4g0LrQu9Cw0YHRgSBcItC90LXQstC40LTQuNC80L7RgdGC0LhcIlxyXG4gICAgICAgIGlmICh0aGlzLl9vd25lcklkICE9PSB0aGlzLl9teUlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkRlbGV0ZS5jbGFzc0xpc3QuYWRkKCdidXR0b24tZGVsZXRlX2luYWN0aXZlJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnRpdGxlQ2FyZCA9IHRoaXMuX25ld0NhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJyk7XHJcbiAgICAgICAgdGhpcy5idXR0b25MaWtlID0gdGhpcy5fbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKCcuYnV0dG9uLWxpa2UnKTtcclxuICAgICAgICB0aGlzLnBob3RvTGlua0NhcmQgPSB0aGlzLl9uZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19waG90bycpO1xyXG4gICAgICAgIHRoaXMuY2FyZENvdW50TGlrZSA9IHRoaXMuX25ld0NhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2NvdW50LWxpa2UnKTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9saWtlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fbGlrZXNbaV0ubmFtZSA9PT0gdGhpcy5fbXlOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXRDbGFzc0xpa2UoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgICAgIHRoaXMudGl0bGVDYXJkLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgICAgICB0aGlzLnBob3RvTGlua0NhcmQuc3JjID0gdGhpcy5fbGluaztcclxuICAgICAgICB0aGlzLnBob3RvTGlua0NhcmQuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgICAgICB0aGlzLmNhcmRDb3VudExpa2UudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLl9uZXdDYXJkO1xyXG4gICAgfVxyXG5cclxuICAgIC8q0KPRgdGC0LDQvdC+0LLQutCwINGB0LvRg9GI0LDRgtC10LvQtdC5Ki9cclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9uZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5idXR0b24tbGlrZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuYnV0dG9uTGlrZS5jbGFzc0xpc3QuY29udGFpbnMoJ2J1dHRvbi1saWtlX2FjdGl2ZScpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRMaWtlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVMaWtlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLl9idXR0b25EZWxldGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdidXR0b24tZGVsZXRlX2luYWN0aXZlJykpIHtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4geyB0aGlzLl9wb3B1cERlbGV0ZSh0aGlzLl9kZWxldGVDYXJkLmJpbmQodGhpcyksIHRoaXMuX2lkKSB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucGhvdG9MaW5rQ2FyZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspOyAvKtCh0YLRgNC10LvQvtGH0L3QsNGPINGE0YPQvdC60YbQuNGPLNGH0YLQvtCx0Ysg0L/RgNC40L3QuNC80LDQu9CwINCy0LXRgNC90YvQuSB0aGlzLiDQotCw0Log0LbQtSDQvNC+0LbQvdC+INC40YHQv9C+0LvRjNC30L7QstCw0YLRjCDQvNC10YLQvtC0IGJpbmQoKSovXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2FkZExpa2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcHV0TGlrZXModGhpcy5faWQpLnRoZW4oKHIpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fc2V0Q2xhc3NMaWtlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2FyZENvdW50TGlrZS50ZXh0Q29udGVudCA9IHIubGlrZXMubGVuZ3RoO1xyXG4gICAgICAgIH0pLmNhdGNoKGUgPT4gY29uc29sZS5lcnJvcihlKSk7XHJcbiAgICB9XHJcblxyXG4gICAgX3JlbW92ZUxpa2UoKSB7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlTGlrZXModGhpcy5faWQpLnRoZW4oKHIpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fc2V0Q2xhc3NMaWtlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2FyZENvdW50TGlrZS50ZXh0Q29udGVudCA9IHIubGlrZXMubGVuZ3RoO1xyXG4gICAgICAgIH0pLmNhdGNoKGUgPT4gY29uc29sZS5lcnJvcihlKSk7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldENsYXNzTGlrZSgpIHtcclxuICAgICAgICB0aGlzLmJ1dHRvbkxpa2UuY2xhc3NMaXN0LnRvZ2dsZSgnYnV0dG9uLWxpa2VfYWN0aXZlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgX2RlbGV0ZUNhcmQoKSB7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlRG9tQ2FyZCgpO1xyXG4gICAgICAgIHRoaXMuX25ld0NhcmQgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIF9kZWxldGVEb21DYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX25ld0NhcmQucmVtb3ZlKCk7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybSkge1xyXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcclxuICAgICAgICB0aGlzLl9mb3JtID0gZm9ybTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChgJHt0aGlzLl9jb25maWcuaW5wdXRTZWxlY3Rvcn1gKSk7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgJHt0aGlzLl9jb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3J9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyrQktC60LvRjtGH0LXQvdC40LUg0LLQsNC70LjQtNCw0YbQuNC4INGE0L7RgNC80YsqL1xyXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICAvLyDRh9GC0L7QsdGLINC/0YDQvtCy0LXRgNC40YLRjCDRgdC+0YHRgtC+0Y/QvdC40LUg0LrQvdC+0L/QutC4INCyINGB0LDQvNC+0Lwg0L3QsNGH0LDQu9C1XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIC8vINGH0YLQvtCx0Ysg0L/RgNC+0LLQtdGA0Y/RgtGMINC10LPQviDQv9GA0Lgg0LjQt9C80LXQvdC10L3QuNC4INC70Y7QsdC+0LPQviDQuNC3INC/0L7Qu9C10LlcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke3RoaXMuX2NvbmZpZy5lcnJvckNsYXNzfV8ke2lucHV0RWxlbWVudC5pZH1gKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoYCR7dGhpcy5fY29uZmlnLmVycm9yQ2xhc3N9X2FjdGl2ZWApO1xyXG4gICAgfTtcclxuXHJcbiAgICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHt0aGlzLl9jb25maWcuZXJyb3JDbGFzc31fJHtpbnB1dEVsZW1lbnQuaWR9YCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoYCR7dGhpcy5fY29uZmlnLmVycm9yQ2xhc3N9X2FjdGl2ZWApO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG4gICAgfTtcclxuXHJcbiAgICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudClcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHNlbGVjdG9yUG9wdXApIHtcclxuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JQb3B1cCk7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uQ2xvc2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcuYnV0dG9uLWNsb3NlJyk7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2ViaW5kID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZWJpbmQpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZWJpbmQpO1xyXG4gICAgfVxyXG4gICAgLyrQl9Cw0LrRgNGL0YLQuNC1IHBvcHVwINC60LvQsNCy0LjRiNC10LkgRXNjKi9cclxuICAgIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgICAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgLyrQo9GB0YLQsNC90L7QstC60LAg0YHQu9GD0YjQsNGC0LXQu9GPINC90LAg0LrQvdC+0L/QutGDIENsb3NlKi9cclxuICAgICAgICB0aGlzLl9idXR0b25DbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xvc2UuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgLyrQo9GB0YLQsNC90L7QstC60LAg0YHQu9GD0YjQsNGC0LXQu9GPINC90LAgT3ZlcmxheSovXHJcbiAgICAgICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn1cclxuXHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3Ioc2VsZWN0b3JQb3B1cCwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgICAgIHN1cGVyKHNlbGVjdG9yUG9wdXApO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uU3VibWl0ID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLmJ1dHRvbi1zdWJtaXQnKTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcuaW5wdXQnKVxyXG4gICAgICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAgICAgdGhpcy5mb3JtVmFsdWVzID0ge307XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXQgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5mb3JtVmFsdWVzXHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY29udGFpbmVyJyk7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCksIHRoaXMuX2J1dHRvblN1Ym1pdCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIC8vINCy0YHRgtCw0LLQu9GP0LXQvCDQsiBgdmFsdWVgINC40L3Qv9GD0YLQsCDQtNCw0L3QvdGL0LUg0LjQtyDQvtCx0YrQtdC60YLQsCDQv9C+INCw0YLRgNC40LHRg9GC0YMgYG5hbWVgINGN0YLQvtCz0L4g0LjQvdC/0YPRgtCwXHJcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9mb3JtLnJlc2V0KCk7LyrQntGH0LjRgdGC0LrQsCDRhNC+0YDQvNGLKi9cclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0ICcuL2luZGV4LmNzcydcclxuXHJcbmltcG9ydCB7IGJ1dHRvbkVkaXQsIGJ1dHRvbkFkZCwgY29uZmlnLCBmb3JtVmFsaWRhdG9ycywgYXZhdGFyLCBhcGlEYXRhIH0gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnRzLmpzJztcclxuaW1wb3J0IENhcmQgZnJvbSAnLi4vY29tcG9uZW50cy9DYXJkLmpzJ1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tICcuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMnXHJcbmltcG9ydCBTZWN0aW9uIGZyb20gJy4uL2NvbXBvbmVudHMvU2VjdGlvbi5qcydcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMnXHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcydcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gJy4uL2NvbXBvbmVudHMvVXNlckluZm8uanMnXHJcbmltcG9ydCBBcGkgZnJvbSAnLi4vY29tcG9uZW50cy9BcGkuanMnXHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMnXHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKGFwaURhdGEpO1xyXG5jb25zdCBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKHtcclxuICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChpdGVtKTtcclxuICAgICAgICBjYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgIH1cclxufSwgJy5jYXJkcycpO1xyXG5jb25zdCBwb3B1cEVkaXQgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX2Zvcm1fZWRpdCcsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcclxuY29uc3QgcG9wdXBBZGQgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX2Zvcm1fYWRkJywgaGFuZGxlQ2FyZEZvcm1TdWJtaXQpO1xyXG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKCcucG9wdXBfcGhvdG8nKTtcclxuY29uc3QgcG9wdXBEZWxldGUgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKCcucG9wdXBfZm9ybV9kZWxldGUnLCBoYW5kbGVEZWxldGVDYXJkU3VibWl0KTtcclxuY29uc3QgcG9wdXBVcGRhdGVBdmF0YXIgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX2Zvcm1fdXBkYXRlQXZhdGFyJywgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCk7XHJcbmNvbnN0IHVzZXJEYXRhID0gbmV3IFVzZXJJbmZvKCcucHJvZmlsZV9fbmFtZScsICcucHJvZmlsZV9fc3RhdHVzJywgJy5wcm9maWxlX19hdmF0YXInKTtcclxuXHJcbnBvcHVwSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vINCS0LrQu9GO0YfQtdC90LjQtSDQstCw0LvQuNC00LDRhtC40LhcclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICAgIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtKSlcclxuICAgIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICAgICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBmb3JtRWxlbWVudClcclxuICAgICAgICAvLyDQv9C+0LvRg9GH0LDQtdC8INC00LDQvdC90YvQtSDQuNC3INCw0YLRgNC40LHRg9GC0LAgYG5hbWVgINGDINGE0L7RgNC80YtcclxuICAgICAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZSgnbmFtZScpXHJcblxyXG4gICAgICAgIC8vINCy0L7RgiDRgtGD0YIg0LIg0L7QsdGK0LXQutGCINC30LDQv9C40YHRi9Cy0LDQtdC8INC/0L7QtCDQuNC80LXQvdC10Lwg0YTQvtGA0LzRi1xyXG4gICAgICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuICAgICAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKGNvbmZpZyk7XHJcblxyXG4vL9Cf0LXRgNCy0L7QvdCw0YfQsNC70YzQvdCw0Y8g0LfQsNCz0YDRg9C30LrQsCDQuNC90YTQvtGA0LzQsNGG0LjQuCDQviDQv9C+0LvRjNC30L7QstCw0YLQtdC70LUg0Lgg0YEg0YHQtdGA0LLQtdGA0LAg0Lgg0L/QvtC70YPRh9C10L3QuNC1INC90LDRh9Cw0LvRjNC90YvRhSDQutCw0YDRgtC+0YfQtdC6XHJcblByb21pc2UuYWxsKFthcGkuZ2V0RGF0YVByb2ZpbGUoKSwgYXBpLmdldERhdGFDYXJkKCldKVxyXG4gICAgLnRoZW4oKFtpdGVtc1VzZXJEYXRhLCBpdGVtc0NhcmRdKSA9PiB7XHJcbiAgICAgICAgdXNlckRhdGEuc2F2ZVNlcnZlckluZm9ybWF0aW9uKGl0ZW1zVXNlckRhdGEpO1xyXG4gICAgICAgIHVzZXJEYXRhLnNldFVzZXJJbmZvKGl0ZW1zVXNlckRhdGEubmFtZSwgaXRlbXNVc2VyRGF0YS5hYm91dCk7XHJcbiAgICAgICAgdXNlckRhdGEuc2V0VXNlckF2YXRhcihpdGVtc1VzZXJEYXRhLmF2YXRhcik7XHJcbiAgICAgICAgLy/QstGL0LfQvtCyINGA0LXQvdC00LXRgNCwINC90LDRh9Cw0LvRjNC90YvRhSDQutCw0YDRgtC+0YfQtdC6XHJcbiAgICAgICAgY2FyZExpc3QucmVuZGVySXRlbXMoaXRlbXNDYXJkKTtcclxuICAgIH0pO1xyXG5cclxuLyrQodC+0LfQtNCw0L3QuNC1INC90L7QstGL0YUg0LrQsNGA0YLQvtGH0LXQuiovXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQob2JqKSB7XHJcbiAgICAvL9Cn0YLQvtCx0Ysg0L/RgNC4INC/0LXRgNC10LTQsNGH0LUg0LzQtdGC0L7QtNCwINC90LUg0YLQtdGA0Y/Qu9GB0Y8g0LrQvtC90YLQtdC60YHRgiB0aGlzINC80LXRgtC+0LTRiyDQt9Cw0L/QuNGB0LDQvdGLINC60LDQuiDRgdGC0YDQtdC70L7Rh9C90YvQtSDRhNGD0L3QutGG0LjQuFxyXG4gICAgY29uc3QgY2FyZE5ldyA9IG5ldyBDYXJkKG9iaiwgJy50ZW1wbGF0ZV9fY2FyZCcsIGhhbmRsZUNhcmRDbGljaywgYXBpLmRlbGV0ZUxpa2VzLCBhcGkucHV0TGlrZXMsXHJcbiAgICAgICAgcG9wdXBEZWxldGUub3Blbi5iaW5kKHBvcHVwRGVsZXRlKSwgdXNlckRhdGEuZ2V0RnVsbFBhY2tJbmZvT2JqKTtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZE5ldy5jcmVhdGVDYXJkKCk7XHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnRcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKG5hbWUsIHVybCkge1xyXG4gICAgcG9wdXBJbWFnZS5vcGVuKG5hbWUsIHVybCk7XHJcbn1cclxuXHJcbi8q0KHQvtGF0YDQsNC90LXQvdC40LUg0Lgg0L7RgtGB0YvQu9C60LAg0LTQsNC90L3Ri9GFINGE0L7RgNC80Ysg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjRjyDQvdCwINGB0LXRgNCy0LXRgCovXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KG9iaiwgYnV0dG9uU3VibWl0KSB7XHJcbiAgICByZW5kZXJMb2FkaW5nKHRydWUsIGJ1dHRvblN1Ym1pdCk7XHJcbiAgICBhcGkuc2VuZERhdGFQcm9maWxlKG9iaikudGhlbihvYmogPT4ge1xyXG4gICAgICAgIHVzZXJEYXRhLnNldFVzZXJJbmZvKG9iai5uYW1lLCBvYmouYWJvdXQpO1xyXG4gICAgICAgIHBvcHVwRWRpdC5jbG9zZSgpO1xyXG4gICAgfSkuY2F0Y2goZSA9PiBjb25zb2xlLmVycm9yKGUpKS5maW5hbGx5KCgpID0+IHsgcmVuZGVyTG9hZGluZyhmYWxzZSwgYnV0dG9uU3VibWl0KTsgfSk7XHJcbn1cclxuXHJcbi8q0KHQvtGF0YDQsNC90LXQvdC40LUg0Lgg0L7RgtGB0YvQu9C60LAg0LTQsNC90L3Ri9GFINC90LAg0YHQtdGA0LLQtdGALCDQsCDRgtCw0Log0LbQtSDQv9C+0YHQu9C10LTRg9GO0YnQtdC1INC00L7QsdCw0LLQu9C10L3QuNC1INC90L7QstC+0Lkg0LrQsNGA0YLQvtGH0LrQuCovXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRGb3JtU3VibWl0KG9iaiwgYnV0dG9uU3VibWl0KSB7XHJcbiAgICByZW5kZXJMb2FkaW5nKHRydWUsIGJ1dHRvblN1Ym1pdCk7XHJcbiAgICBhcGkucG9zdENhcmQob2JqKS50aGVuKG9iaiA9PiB7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKG9iaik7XHJcbiAgICAgICAgY2FyZExpc3QucHJlcGVuZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgICAgIHBvcHVwQWRkLmNsb3NlKCk7XHJcbiAgICB9KS5jYXRjaChlID0+IGNvbnNvbGUuZXJyb3IoZSkpLmZpbmFsbHkoKCkgPT4geyByZW5kZXJMb2FkaW5nKGZhbHNlLCBidXR0b25TdWJtaXQpOyB9KTtcclxufVxyXG4vKtCj0LTQsNC70LXQvdC40LUg0LrQsNGA0YLQvtGH0LrQuCDRgtC+0LvRjNC60L4g0L/QvtGB0LvQtSDQv9C+0LTRgtCy0LXRgNC20LTQtdC90LjRjyovXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmRTdWJtaXQoZGVsZXRlQ2FyZCwgaWQpIHtcclxuICAgIGFwaS5kZWxldGVDYXJkKGlkKS50aGVuKCgpID0+IHtcclxuICAgICAgICBkZWxldGVDYXJkKCk7XHJcbiAgICAgICAgcG9wdXBEZWxldGUuY2xvc2UoKTtcclxuICAgIH0pLmNhdGNoKGUgPT4gY29uc29sZS5lcnJvcihlKSk7XHJcbn1cclxuXHJcbi8q0KHQvtGF0YDQsNC90LXQvdC40LUg0LTQsNC90L3Ri9GFINC4INC/0L7RgdC70LXQtNGD0Y7RidCw0Y8g0LfQsNC80LXQvdCwINCw0LLQsNGC0LDRgNCwKi9cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChvYmosIGJ1dHRvblN1Ym1pdCkge1xyXG4gICAgcmVuZGVyTG9hZGluZyh0cnVlLCBidXR0b25TdWJtaXQpO1xyXG4gICAgYXBpLnNlbmREYXRhQXZhdGFyKG9iaikudGhlbihvYmogPT4ge1xyXG4gICAgICAgIHVzZXJEYXRhLnNldFVzZXJBdmF0YXIob2JqLmF2YXRhcik7XHJcbiAgICAgICAgcG9wdXBVcGRhdGVBdmF0YXIuY2xvc2UoKTtcclxuICAgIH0pLmNhdGNoKGUgPT4gY29uc29sZS5lcnJvcihlKSkuZmluYWxseSgoKSA9PiB7IHJlbmRlckxvYWRpbmcoZmFsc2UsIGJ1dHRvblN1Ym1pdCk7IH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgYnV0dG9uU3VibWl0KSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgICAgYnV0dG9uU3VibWl0LnRleHRDb250ZW50ID0gJ0PQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBidXR0b25TdWJtaXQudGV4dENvbnRlbnQgPSAnQ9C+0YXRgNCw0L3QuNGC0YwnO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKtCd0LDQstC10YjQuNCy0LDQvdC40LUg0L7QsdGA0LDQsdC+0YLRh9C40LrQvtCyINGB0L7QsdGL0YLQuNC5INC90LAg0LrQvdC+0L/QutC4IGVkaXQsIGFkZCDQuCDQsNCy0LDRgtCw0YAqL1xyXG5idXR0b25FZGl0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgcG9wdXBFZGl0Lm9wZW4oKTtcclxuICAgIHBvcHVwRWRpdC5zZXRJbnB1dFZhbHVlcyh1c2VyRGF0YS5nZXRVc2VySW5mbygpKTtcclxufSk7XHJcbmJ1dHRvbkFkZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgIGZvcm1WYWxpZGF0b3JzWydmb3JtQ2FyZCddLnJlc2V0VmFsaWRhdGlvbigpOyAvKtCS0YvQsdC40YDQsNGOINC90YPQttC90YPRjiDQvNC90LUg0YTQvtGA0LzRgyDQtNC70Y8gdmFsaWQqL1xyXG4gICAgcG9wdXBBZGQub3BlbigpO1xyXG59KTtcclxuYXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgZm9ybVZhbGlkYXRvcnNbJ2Zvcm1VcGRhdGVBdmF0YXInXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICAgIHBvcHVwVXBkYXRlQXZhdGFyLm9wZW4oKTtcclxufSkiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3IoeyBiYXNlVVJMLCBoZWFkZXJzIH0pIHtcclxuICAgICAgICB0aGlzLl9iYXNlVVJMID0gYmFzZVVSTDtcclxuICAgICAgICB0aGlzLl91cmxEYXRhUHJvZmlsZSA9IGAke3RoaXMuX2Jhc2VVUkx9dXNlcnMvbWUvYDtcclxuICAgICAgICB0aGlzLl91cmxDYXJkID0gYCR7dGhpcy5fYmFzZVVSTH1jYXJkcy9gO1xyXG4gICAgICAgIHRoaXMuX3VybEF2YXRhciA9IGAke3RoaXMuX2Jhc2VVUkx9dXNlcnMvbWUvYXZhdGFyL2A7XHJcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGF0YVByb2ZpbGUoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX3VybERhdGFQcm9maWxlLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgICB9KS50aGVuKHJlcyA9PiB0aGlzLl9nZXRSZXNwb25zZURhdGEocmVzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGF0YUNhcmQoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX3VybENhcmQsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBzZW5kRGF0YVByb2ZpbGUob2JqKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX3VybERhdGFQcm9maWxlLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShvYmopLFxyXG4gICAgICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBzZW5kRGF0YUF2YXRhcihvYmopIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fdXJsQXZhdGFyLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShvYmopLFxyXG4gICAgICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBwb3N0Q2FyZCA9IChvYmopID0+IHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fdXJsQ2FyZCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShvYmopLFxyXG4gICAgICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICAgIH1cclxuICAgIC8v0JLRi9Cy0L7QtCDRhNGD0L3QutGG0LjQuCDRh9C10YDQtdC3INGB0YLRgNC10LvQvtGH0L3Rg9GOINGH0YLQvtCx0Ysg0L/RgNC4INC/0LXRgNC10LTQsNGH0LUg0LTQsNC90L3QvtCz0L4g0LzQtdGC0L7QtNCwINCyINC00YDRg9Cz0L7QuSDQutC70LDRgdGBINC90LUg0YLQtdGA0Y/Qu9GB0Y8g0LrQvtC90YLQtdC60YHRgiB0aGlzXHJcbiAgICAvL9Ci0LDQuiDQttC1INCy0L7Qt9C80L7QttC10L0g0LLQsNGA0LjQsNC90YIg0LrQvtCz0LTQsCDQv9GA0Lgg0L/QtdGA0LXQtNCw0YfQtSDQvNC10YLQvtC00LAg0L7QtNC90L7Qs9C+INC60LvQsNGB0YHQsCDQsiDQtNGA0YPQs9C+0Lkg0LrQu9Cw0YHRgVxyXG4gICAgLy/Ql9Cw0LrRgNC10L/Qu9GP0YLRjCB0aGlzINC80LXRgtC+0LTQvtC8IGJpbmQoKVxyXG4gICAgZGVsZXRlQ2FyZCA9IChpZCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmxDYXJkfSR7aWR9YCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSkudGhlbihyZXMgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwdXRMaWtlcyA9IChpZCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmxDYXJkfSR7aWR9L2xpa2VzYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgICB9KS50aGVuKHJlcyA9PiB0aGlzLl9nZXRSZXNwb25zZURhdGEocmVzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlTGlrZXMgPSAoaWQpID0+IHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsQ2FyZH0ke2lkfS9saWtlc2AsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0UmVzcG9uc2VEYXRhKHJlcykge1xyXG4gICAgICAgIGlmICghcmVzLm9rKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9ICAke3Jlcy5zdGF0dXNUZXh0fWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBwcmVwZW5kSXRlbShlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXIoKSB7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XHJcbiAgICAgICAgdGhpcy5jbGVhcigpO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMgPSBpdGVtcztcclxuXHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZWRJdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHNlbGVjdG9yUG9wdXApIHtcclxuICAgICAgICBzdXBlcihzZWxlY3RvclBvcHVwKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEJpZ1Bob3RvID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19iaWdQaG90bycpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwUGhvdG9TdWJ0aXRsZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc3VidGl0bGUnKTtcclxuICAgIH1cclxuICAgIC8q0KPQstC10LvQuNGH0LXQvdC40LUg0YTQvtGC0L4qL1xyXG4gICAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBCaWdQaG90by5hbHQgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwQmlnUGhvdG8uc3JjID0gbGluaztcclxuICAgICAgICB0aGlzLl9wb3B1cFBob3RvU3VidGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3RvcihzZWxlY3RvclBvcHVwLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICAgICAgc3VwZXIoc2VsZWN0b3JQb3B1cCk7XHJcbiAgICAgICAgdGhpcy5oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19jb250YWluZXInKTtcclxuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmhhbmRsZUZvcm1TdWJtaXQodGhpcy5kZWxldGVDYXJkLCB0aGlzLmlkKTtcclxuICAgICAgICAgICAgLypzdXBlci5jbG9zZSgpOyovXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKGRlbGV0ZUNhcmQsIGlkKSB7XHJcbiAgICAgICAgc3VwZXIub3BlbigpXHJcbiAgICAgICAgdGhpcy5kZWxldGVDYXJkID0gZGVsZXRlQ2FyZDtcclxuICAgICAgICB0aGlzLmlkID0gaWRcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICAgIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3Rvciwgc3RhdHVzU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5fcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fcHJvZmlsZVN0YXR1cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc3RhdHVzU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX3Byb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICB0aGlzLl9uYW1lID0gdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgICAgICAgdGhpcy5fYWJvdXQgPSB0aGlzLl9wcm9maWxlU3RhdHVzLnRleHRDb250ZW50O1xyXG5cclxuICAgICAgICB0aGlzLmluZm8gPSB7XHJcbiAgICAgICAgICAgIG5hbWU6IHRoaXMuX25hbWUsXHJcbiAgICAgICAgICAgIGFib3V0OiB0aGlzLl9hYm91dFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmluZm9cclxuICAgIH1cclxuXHJcbiAgICBnZXRGdWxsUGFja0luZm9PYmogPSAoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VzZXJJbmZvcm1hdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBzYXZlU2VydmVySW5mb3JtYXRpb24odXNlckluZm9ybWF0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlckluZm9ybWF0aW9uID0gdXNlckluZm9ybWF0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJJbmZvKGlucHV0TmFtZSwgaW5wdXRTdGF0dXMpIHtcclxuICAgICAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGlucHV0TmFtZTtcclxuICAgICAgICB0aGlzLl9wcm9maWxlU3RhdHVzLnRleHRDb250ZW50ID0gaW5wdXRTdGF0dXM7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXNlckF2YXRhcihhdmF0YXJMaW5rKSB7XHJcbiAgICAgICAgdGhpcy5fcHJvZmlsZUF2YXRhci5zcmMgPSBhdmF0YXJMaW5rO1xyXG4gICAgfVxyXG59Il0sIm5hbWVzIjpbInByb2ZpbGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJidXR0b25FZGl0IiwiYnV0dG9uQWRkIiwiYXZhdGFyIiwiZm9ybVZhbGlkYXRvcnMiLCJDYXJkIiwiY29uc3RydWN0b3IiLCJvYmoiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJkZWxldGVMaWtlcyIsInB1dExpa2VzIiwicG9wdXBEZWxldGUiLCJmdWxsUGFja0luZm9PYmoiLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2xpa2VzIiwibGlrZXMiLCJfb3duZXJJZCIsIm93bmVyIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfZGVsZXRlTGlrZXMiLCJfcHV0TGlrZXMiLCJfcG9wdXBEZWxldGUiLCJfbXlJZCIsIl9teU5hbWUiLCJjcmVhdGVDYXJkIiwiX25ld0NhcmQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2J1dHRvbkRlbGV0ZSIsImNsYXNzTGlzdCIsImFkZCIsInRpdGxlQ2FyZCIsImJ1dHRvbkxpa2UiLCJwaG90b0xpbmtDYXJkIiwiY2FyZENvdW50TGlrZSIsImkiLCJsZW5ndGgiLCJfc2V0Q2xhc3NMaWtlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwidGV4dENvbnRlbnQiLCJzcmMiLCJhbHQiLCJhZGRFdmVudExpc3RlbmVyIiwiY29udGFpbnMiLCJfcmVtb3ZlTGlrZSIsIl9hZGRMaWtlIiwiX2RlbGV0ZUNhcmQiLCJiaW5kIiwidGhlbiIsInIiLCJjYXRjaCIsImUiLCJjb25zb2xlIiwiZXJyb3IiLCJ0b2dnbGUiLCJfZGVsZXRlRG9tQ2FyZCIsInJlbW92ZSIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtIiwiX2NvbmZpZyIsIl9mb3JtIiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImVuYWJsZVZhbGlkYXRpb24iLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiZGlzYWJsZWQiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiZXJyb3JDbGFzcyIsImlkIiwiaW5wdXRFcnJvckNsYXNzIiwicmVzZXRWYWxpZGF0aW9uIiwiUG9wdXAiLCJzZWxlY3RvclBvcHVwIiwiX3BvcHVwIiwiX2J1dHRvbkNsb3NlIiwiX2hhbmRsZUVzY0Nsb3NlYmluZCIsIl9oYW5kbGVFc2NDbG9zZSIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2J1dHRvblN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsImZvcm1WYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJzZXRJbnB1dFZhbHVlcyIsImRhdGEiLCJyZXNldCIsImFwaSIsImJhc2VVUkwiLCJoZWFkZXJzIiwiZmV0Y2giLCJfdXJsQ2FyZCIsIm1ldGhvZCIsIl9oZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZXMiLCJfZ2V0UmVzcG9uc2VEYXRhIiwiX2Jhc2VVUkwiLCJfdXJsRGF0YVByb2ZpbGUiLCJfdXJsQXZhdGFyIiwiZ2V0RGF0YVByb2ZpbGUiLCJnZXREYXRhQ2FyZCIsInNlbmREYXRhUHJvZmlsZSIsInNlbmREYXRhQXZhdGFyIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsInN0YXR1c1RleHQiLCJhdXRob3JpemF0aW9uIiwiY2FyZExpc3QiLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJlbGVtZW50IiwiYXBwZW5kIiwicHJlcGVuZEl0ZW0iLCJwcmVwZW5kIiwiY2xlYXIiLCJpbm5lckhUTUwiLCJyZW5kZXJJdGVtcyIsIml0ZW1zIiwiX3JlbmRlcmVkSXRlbXMiLCJpdGVtIiwiY2FyZEVsZW1lbnQiLCJwb3B1cEVkaXQiLCJidXR0b25TdWJtaXQiLCJyZW5kZXJMb2FkaW5nIiwidXNlckRhdGEiLCJzZXRVc2VySW5mbyIsImFib3V0IiwiZmluYWxseSIsInBvcHVwQWRkIiwicG9zdENhcmQiLCJwb3B1cEltYWdlIiwiX3BvcHVwQmlnUGhvdG8iLCJfcG9wdXBQaG90b1N1YnRpdGxlIiwiZGVsZXRlQ2FyZCIsInBvcHVwVXBkYXRlQXZhdGFyIiwic2V0VXNlckF2YXRhciIsIm5hbWVTZWxlY3RvciIsInN0YXR1c1NlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfdXNlckluZm9ybWF0aW9uIiwiX3Byb2ZpbGVOYW1lIiwiX3Byb2ZpbGVTdGF0dXMiLCJfcHJvZmlsZUF2YXRhciIsImdldFVzZXJJbmZvIiwiX2Fib3V0IiwiaW5mbyIsInNhdmVTZXJ2ZXJJbmZvcm1hdGlvbiIsInVzZXJJbmZvcm1hdGlvbiIsImlucHV0TmFtZSIsImlucHV0U3RhdHVzIiwiYXZhdGFyTGluayIsImdldEZ1bGxQYWNrSW5mb09iaiIsInVybCIsImlzTG9hZGluZyIsImZvcm1FbGVtZW50IiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJhbGwiLCJpdGVtc1VzZXJEYXRhIiwiaXRlbXNDYXJkIl0sInNvdXJjZVJvb3QiOiIifQ==